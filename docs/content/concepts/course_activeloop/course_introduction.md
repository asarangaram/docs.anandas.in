
# Course Introduction and Logistics
## Introduction to the ‚ÄúTraining and Fine-tuning LLMs for Production‚Äù Course

Activeloop, Towards AI, and Intel¬Æ Disruptor Initiative are excited to collaborate to bring Gen AI 360: Foundational Model Certification Course to aspiring Generative AI professionals, executives, and enthusiasts of tomorrow.

Following the success of our **"LangChain & Vector Databases In Production"** course, we're excited to welcome you to part two of the series, "Training and Fine-tuning LLMs for Production." In this course, you will cover the intricacies of training, fine-tuning, and seamlessly integrating these models into AI products. This course will guide you on the most effective methods and best practices for preparing LLMs for production. Let's begin!
Why This Course?

The ‚ÄúTraining and Fine-tuning LLMs for Production‚Äù course provides the theoretical knowledge and practical skills necessary to work with these models.

A fundamental pillar of our course is hands-on learning. We are grounded in the belief that practical application and experimentation form the cornerstone of truly understanding and utilizing the strengths of LLMs.

You will acquire the skills to train, refine, and adapt LLMs for specific tasks and integrate them seamlessly into your products and applications.

We navigate deeper to understand the complex layers of LLMs, touching upon the architectural frameworks of Transformers and GPT models. We also explore the metrics used for performance evaluation, ensuring a comprehensive understanding of the whole process involved in gearing LLMs for production.
Who Should Take This Course?

This course is designed with a wide audience in mind, including beginners in AI, current machine learning engineers, students, and professionals considering a career transition to AI. Please know that prior knowledge of coding and Python is a prerequisite.

We aim to provide you with the necessary tools to apply and tailor Large Language Models across a wide range of industries to make AI more accessible and practical. 
What You Will Learn

As we progress, you'll become familiar with the architecture of Transformers and Generative Pre-trained Transformers (GPTs) and learn more about prompting LLMs to produce specific outputs. Essential topics such as proprietary versus open-source models, various LLM training methodologies, and production deployment strategies will be covered. We also touch upon advanced fine-tuning techniques like LoRA, QLoRA, SFT, and RLHF.

As the course progresses, you'll engage in several projects crafted to offer you hands-on experience while reinforcing your grasp of LLMs.

One standout project will guide you through the process of Supervised Fine-Tuning focused on financial sentiment analysis. Here, you'll become adept at various strategies for refining LLMs and get a clear perspective on datasets designed for tailoring LLMs to specific, goal-oriented tasks.
## Is the Course Free?

Yes, the course is entirely free for everybody.
Estimated cost of running the code examples in the course

Running the code examples in the course may require additional costs, but please note that this is not a requirement for course completion.

This course includes multiple coding projects, including one on pre-training a language model using Lambda Labs GPUs, another on fine-tuning an LLM on GPUs through RLHF, and additional ones on fine-tuning LLMs on CPUs. We made an effort to keep the costs low so that more students could easily replicate them. You can still complete the course and pass chapter quizzes without running these projects or paying anything.

The main cost, of course, would be the pre-training of the language model (so, GPUs), but you can start it and stop it after a few iterations, spending a few dollars just for the experience of setting up the infrastructure. Expect to spend something between $50 and $100, if you wish to complete the fine-tuning examples. Always beware of the costs you're incurring when you borrow AI hardware (GPUs or CPUs with a lot of RAM), and make sure not to use them for more time than necessary.

For CPUs renting, we use Google Cloud Platform which give free credits of the value of 300$ to be used in three months after signup. These free credits can be used with Compute Engine to rent CPUs. We explain how to do that in a later section.
Will platform and cloud credits be available for students of the course?

We will also be providing grants and credits in collaboration with our partners to complete the training or fine-tuning examples. Everyone will get free access to Deep Lake for the course but some other credits will only be available according to certain criteria and course completion milestones. 

All course takers can redeem a free extended trial of one month for the Activeloop Growth plan by redeeming GENAI360 promo code at checkout.
Cohere Credits - $75 in Cohere Production Credits

As a part of the course, qualifying course takers that reach and complete all course quizzes up to and including the Fine-tuning LLMs Chapter, will have the opportunity to apply for $75 in Cohere Production credits that will be sufficient to train a custom model with Cohere. 

After completing, please fill in this form. We will be notified and get back to you if (1) Grant has not been fully redeemed by other students (2) you successfully meet the qualifying criteria to be granted credits. 

Please make sure that your Activeloop, Activeloop Learn / GenAI360 account emails, and Cohere platform email address are the same.
Lambda Credits - $100 in Lambda Credits

**As a part of the course, qualifying course takers who reach and complete all course quizzes up to and including the Fine-tuning LLMs Chapter, will have the opportunity to apply for $100 in Lambda credits to run the hands-on examples we have in this course.**

Please note that Lambda is constantly adding to GPU capacity and industry-leading rates to democratize access to GPUs. However, credit redemption is subject to the ever-changing market dynamics of GPU supply and demand. It may be the case that you're granted the credits but are not able to immediately redeem them through the Lambda on-demand pool. Once granted, you will have an opportunity to redeem the credits within 12 months of issuance. 

Once you confirm you've passed the required quizzes, please fill out the following form to redeem the credits. By filling out the form, you agree with Lambda Terms & Conditions and Privacy policy.
Activeloop Credits - Free Extended Trial for Deep Lake Growth Plan for a Month

As a part of the course, all course takers can redeem a free extended trial of one month for the Activeloop Growth plan by redeeming GENAI360 promo code at checkout. To redeem the plan
## Certification
By participating in this course and completing the quizzes at the end of each chapter, you will have the opportunity to earn a certification in using Deep Lake - a valuable addition to your professional credentials. This certification program, offered at no cost, forms part of the GenAI360 Foundational Model Certification program in collaboration with Intel¬Æ Disruptor Initiative and Towards AI.

## Course Logistics

Here's everything you need to know about the course.
## Course Hosting and Pace

This course is hosted by Activeloop. It is designed as a self-paced learning journey, allowing you to proceed at your own comfort. The online format provides flexibility, enabling you to engage with the lessons whenever it best suits you.

At the end of each module, you can test your new knowledge with multiple-choice quizzes, which are mandatory to continue the course. After completing all the quizzes, you will receive your course certification.
## Community Support

Have questions about this course or specific lessons? Want to exchange ideas with fellow learners? We encourage active interaction in the dedicated forum in the Towards AI‚Äôs Learn AI Together Discord Community. This vibrant community is comprised of over 50,000 AI experts and enthusiasts. Our community has a dedicated channel for this course where you can pose questions and share insights.

For queries specifically related to Deep Lake, please join the Deep Lake Slack community, where experts and users will be ready to assist.
# Required Platforms, Tools, and Cloud Tokens

The course involves practical projects and exercises that require various tools and platforms. These will be thoroughly guided in the individual lessons. However, the main platforms that you will use throughout the course are:

	Activeloop‚Äôs Deep Lake
	Lambda Lab‚Äôs cloud infrastructure
	Google Cloud Platform (GCP)
	Google Cloud Compute Engine (GCE)
	Weights & Biases
	Cohere

## What is Activeloop?

Activeloop is a tech company dedicated to building data infrastructure optimized for deep-learning applications. It offers a platform that seamlessly connects unstructured data types, like audio, video, and images, to machine learning models. Their main product, Deep Lake, ensures data streaming, scalable machine learning pipelines, and dataset version control. Such infrastructures are particularly beneficial when dealing with the demands of training and fine-tuning models for production.
## What is Deep Lake?

Activeloop Deep Lake is an open-source data lake designed for deep learning applications. It retains essential features of traditional data lakes, including SQL queries, ACID transactions, and dataset visualization. It specializes in storing complex data in tensor form, efficiently streaming data to deep learning frameworks. Built to be serverless on a columnar storage format, it also offers native version control and in-browser data visualization, complementing the needs of LLM training and deployment processes.
How to set up a Deep Lake account?

To set up a Deep Lake account, navigate to the app‚Äôs registration page and sign up. Follow the on-screen instructions and add the required details. Once you've verified your email and established a secure password, your account will be active and ready for use.

How to get the Deep Lake API token?

    After logging in, you should see your homepage. You should now see a ‚ÄúCreate API token‚Äù button at the top of your homepage. Click on it, and you‚Äôll get redirected to the ‚ÄúAPI tokens‚Äù page. This is where you can generate, manage, and revoke your API keys for accessing Deep Lake.
    Click on the "Create API token" button. You should see a popup asking for a token name and an expiration date. By default, the token expiration date is one year. Once you‚Äôve set the token name and its expiration date, click the ‚ÄúCreate API token‚Äù button.
    You should now see a green banner saying that the token has been successfully generated, along with your new API token, on the ‚ÄúAPI tokens‚Äù page. To copy your token to your clipboard, click the square icon on its right.

What is Lambda?

Lambda was founded by Machine Learning engineers and builders. They empower founders, researchers, and ML practitioners with access to best-in-class deep learning infrastructure, from single on-demand GPU instances to the highest-performing clusters with thousands of GPUs interconnected across a non-blocking network fabric. Lambda helps teams deploy affordable infrastructure anywhere, whether it's their own data centers or in our hosted cloud. Lambda Labs enables companies to start building affordably and scale their AI/ML workloads with industry-leading pricing from A10 instances to the latest H100 architecture. Lambda serves a community of over 80,000 ML Engineers across Startups and Fortune 100 enterprises.
How to Create an Account:

    Registration: On the Lambda website navigate to the cloud sign in, and register for a new account by clicking the ‚Äúsign up‚Äù button. Provide necessary details like your email address, and agreeing to the terms of service. Important: To qualify for cloud credits (more on this in course logistics), please make sure your email matches the email on your Activeloop and Gen AI 360 Certification (learn.activeloop.ai) email account.
    In the ‚ÄòCreate your free account‚Äô section, fill the form with the details, such as Account type - click on ‚ÄòIndividual.‚Äô Provide your information and click ‚ÄòRegister‚Äô.
    In ‚ÄòTerms of Service‚Äô, Click on the checkbox ‚ÄòI agree‚Äô.
    Email Verification: After registration, you'll receive an email for account verification. Follow the provided link to confirm your email and log into your Lambda Cloud dashboard.

How to Connect to a Machine:

    Launching an Instance: Select the "Launch Instance" option on your dashboard. First-time users will be prompted to upload an SSH key.
    Machine Access: Once your instance is up and running, the dashboard will provide you with essential details to initiate your machine usage.

How to upload an SSH key?

Uploading an SSH Key

    Locate your existing public key, usually found under your home directory, in a folder called ~/.ssh/ 
    You can use the command ls -a ~/.ssh/ to find the key. The public key name usually looks like id_rsa.pub or name-you-gave-it.pub .
    To see the contents of the key, use the command cat ~/.ssh/name-you-gave-it.pub, replacing name-you-gave-it with the actual name of your key.
    Copy all the contents, starting with ssh-rsa, and paste them into the text field on the dashboard. More information on: lambdalabs.com.

How to Use Free Credits:

New users get complimentary credits on Lambda. To utilize these credits, initiate an instance following account creation. As you use the service, your free credits will automatically be used up before additional billing occurs.
What is GCP?

Google Cloud Platform (GCP) is Google's comprehensive cloud computing suite, with a variety of services including computing, storage, data analytics, machine learning, and networking, all built on the same infrastructure that powers Google's products.
Creating an Account on GCP:

Google Account Access: Sign in to your existing Google account. This allows you to assess the performance and offerings of Google's products in real-time scenarios.

    Go to https://cloud.google.com/ and click on ‚ÄòTRY IT FREE‚Äò.
    Login to your Gmail account, choose your country and accept the terms & conditions.
    Fill in: Account type, Name, Address, credit card details, tax information, etc (If you have an old Gmail account and all the information is already there, it would take it, and you might not have to fill in all the details).
    Click on ‚ÄúStart my free trial‚Äú.

Note: Credit Card is a must to create a Google Cloud Platform account.

You‚Äôll be given free credits of the value of 300$ that you can use to experiment with the platform.

Here are some instructions on how to create a GCP project using the gcloud command line tool (follow these instructions to install it). Alternatively, you can create a project using the UI of the platform.

    Initiating the gcloud CLI: Initialize the Command Line Interface specific to Google Cloud, termed as 'gcloud,‚Äô by executing the gcloud init command.
    Google Cloud Project Management:
        If you intend to use GCP temporarily, setting up a new Google Cloud project is recommended. This ensures that after evaluation, you can efficiently delete the project, subsequently removing all linked resources.
        To initiate a new Google Cloud project, input gcloud projects create PROJECT_ID, replacing 'PROJECT_ID' with a unique name for your project.
        To choose the recently created Google Cloud project, enter the command gcloud config set project PROJECT_ID.
    Billing Setup: For comprehensive details and guidelines on this, you can refer to their official documentation at cloud.google.com.

Once you have a GCP project, it‚Äôs possible to create a Compute Engine instance by searching for ‚ÄúCompute Engine‚Äù in the search bar on top of the page and then clicking on the ‚ÄúCompute Engine‚Äù search result. We‚Äôll need a Compute Engine instance later in the course, so for now just read these instructions without executing them. Keep in mind that you‚Äôll use your credits whenever you keep a VM on, so always remember to delete the instance once you‚Äôre done with your work.

To create a Compute Engine instance, you can then click on the ‚ÄúCreate Instance‚Äù button and choose a machine configuration. In the course we‚Äôll use high-end Intel¬Æ CPUs, which means the ‚ÄúC3‚Äù option from the list.
image

Then, you can click on ‚ÄúCreate‚Äù. After some time, you‚Äôll see the following.
image

By clicking on ‚ÄúSSH‚Äù you can SSH into the instance and have a terminal session. You can finally delete the instance by selecting it and then clicking on ‚ÄúDelete‚Äù.
image
What is Google Cloud Compute Engine (GCE)?

Google Compute Engine is a component of Google Cloud Platform (GCP) that offers virtual machines running in Google's data centers and worldwide fiber network. It provides scalable and flexible computing capabilities, allowing you to leverage the power of Google's infrastructure.

We‚Äôll use Compute Engine in a few lessons to spin up virtual machines that we‚Äôll use for fine-tuning LLMs leveraging CPUs. Indeed, LLM fine-tuning can be done in a reasonable time leveraging CPUs too, and they are also definitely more available than cloud GPUs today.

Here are the steps to set up a Compute Engine on the Google Cloud Platform:

    Create a Google Cloud Account: You first need to create a Google Cloud account if you don't already have one. This will involve signing up with your Google account credentials, accepting the terms and conditions, and setting up billing information.
    Create a Project: Create a new project in the Google Cloud Console after setting up your account. A project organizes all your Google Cloud resources. A project consists of a set of users and APIs, as well as billing, authentication, and monitoring settings for those APIs. So, for example, all of your Cloud Storage buckets and objects, along with user and API access to them, are controlled by a project.
    Enable Compute Engine API: Next, enable the Compute Engine API for your project. This allows you to interact with the Compute Engine and is necessary to create and manage instances.
    Create a Compute Engine Instance: Now, you can create a Compute Engine instance. This involves choosing the machine type, boot disk, and other configurations based on your requirements. You can do this either through the Google Cloud Console or through the Google Cloud CLI if you have it installed.
    Configure the Instance: After creating your Compute Engine instance, you can configure it to suit your needs. This might involve setting up networking, attaching additional storage, and installing any necessary software.
    Deploy Your Code: Finally, you can deploy your code to the Compute Engine instance. This process will vary depending on the specifics of your application and how it's designed to run.

What is Weights & Biases?

Weights & Biases is a sophisticated tool tailored for machine learning. It specializes in experiment tracking, dataset versioning, and comprehensive model management. Its platform is designed for developers, offering a unified space for logging experiments, visualizing data, and collaborating with team members.
Creating an Account on Weights & Biases:

    Navigate to the Weights & Biases official website: 
    Click on the "Sign Up" option, in the top-right corner of the initial page.
    W&B offers a variety of sign-up methods: via GitHub, Google, LinkedIn, or by manually entering an email address and a desired password.
    After you sign up, a verification email will be sent to the email address you provided. Activate your account by clicking on the link in this email.

Accessing Your Weights & Biases Account:

    Again, head over to the official Weights & Biases website.
    Select the "Log In" option in the top-right corner.
    Input your login details with your chosen sign-up method (GitHub, Google, LinkedIn, or your unique email-password combination).
    Finalize by selecting the "Log In" option, granting you access to your personal account.

What is Cohere?

Cohere is a platform that provides AI language models that can be used to build applications that generate human-like text. It allows developers to leverage these models through APIs, with features including text embedding, rerank, text summarization, question answering, text generation, etc. The platform enables the creation of Retrieval Augmented Generation (RAG) applications and enhances the Semantic Search using the generated embeddings. Some of the main benefits of using Cohere's platform include its simplicity, the quality of its models, and the flexibility it provides for application development. Cohere also allows you to fine-tune its LLMs with your data. We‚Äôll use Cohere in this course to fine-tune an LLM to extract chemical-disease interactions from biomedical papers accurately.
An overview of the
An overview of the Cohere platform.
How to create Cohere account?

Setting up an account on Cohere is a straightforward process. Here's a step-by-step guide:

    Visit the Cohere website: Go to Cohere's website.
    Sign Up: Click on the 'Sign Up' button on the top right corner of the website, leading you to the registration form.
    Fill out the Registration Form: Enter essential details like your email address and password. Ensure you review and accept the terms of service and privacy policy.
    Verification: After submission of the form, check your email for a verification link. Activate your account by clicking the provided link.
    Dashboard Access: Post verification, you'll be directed to your Cohere dashboard, allowing you to tweak account settings, monitor usage, and retrieve your API keys.

Note: To utilize Cohere's API, you'll need to generate an API key from your dashboard. This key will be used to authenticate your application's requests to Cohere's API.
Coding Environment and Packages

Before starting this course, you need to ensure that you have the appropriate coding environment ready. Please make sure to use a Python version equal to or later than 3.8.1. You can set up your environment by choosing one of the following options:

    Having a code editor installed on your computer. A popular coding environment is Visual Studio Code.
    Using Python virtual environments to manage Python libraries.
    Alternatively, you could use Google Colab notebooks.

You will need the following packages to execute the sample codes provided in each lesson successfully. They can be installed using the pip package manager.
Copy

deeplake==3.6.19
openai==0.27.8
tiktoken==0.4.0
transformers==4.32.0
torch==2.0.1
numpy==1.23.5
deepspeed==0.10.1
trl==0.7.1
peft==0.5.0
wandb==0.15.8
bitsandbytes==0.41.1
accelerate==0.22.0
tqdm==4.66.1
neural_compressor===2.2.1
onnx===1.14.1
pandas==2.0.3
scipy==1.11.2

While we strongly recommend installing the latest versions of these packages, please note that the codes have been tested with the versions specified in parentheses. Moreover, specific lessons may require the installation of additional packages, which will be explicitly mentioned. The following code will demonstrate how to install a package using pip.
Copy

pip install deeplake
# Or: (to install an specific version)
# pip install deeplake==3.6.5

üí°
If you encounter any issues while installing the packages, don't hesitate to reach out to us via Activeloop's Slack channel or the live chat on the website. We are here to assist you.
Google Colab

Google Colaboratory, popularly known as Google Colab, is a free cloud-based Jupyter notebook environment. Data scientists and engineers widely use it to train machine learning and deep learning models using CPUs, GPUs, and TPUs. Google Colab comes with an array of features such as:

    Free access to GPUs and TPUs for accelerated model training.
    A web-based interface for a service running on a virtual machine, eliminating the need for local software installation.
    Seamless integration with Google Drive and GitHub.

To use Google Colab, all you need is a Google account. You can run terminal commands directly in notebook cells by appending an exclamation mark (!) before the command. Every notebook created in Google Colab gets stored in your Google Drive for easy access.

A convenient way of using API keys in Colab involves:

    Saving them in a file named .env on your Google Drive. Here‚Äôs how the file should be formatted to save the Activeloop token and the OpenAI API key.

Copy

ACTIVELOOP_TOKEN=your_activeloop_token
OPENAI_API_KEY=your_openai_key

    Mounting your Google Drive on your Colab instance.
    Loading them as environment variables using the dotenv library, like in the following code.

Copy

from dotenv import load_dotenv

load_dotenv('/content/drive/MyDrive/path/to/.env')

Creating Python Virtual Environments

Python virtual environments offer an excellent solution for managing Python libraries and avoiding package conflicts. They create isolated environments for installing packages, ensuring that your packages and their dependencies are contained within that environment. This setup provides clean and isolated environments for your Python projects.

Begin by executing the python command in your terminal to confirm that the Python version is either equal to or greater than 3.8.1. Then follow these steps to create a virtual environment:

    Create a virtual environment using the command python -m venv my_venv_name.
    Activate the virtual environment by executing source my_venv_name/bin/activate.
    Install the required libraries and run the code snippets from the lessons within the virtual environment.

üìù Legal Note on Availability of Credits & Applicable Terms üìù

Availability of Credits:

    Validity: Credits acquired upon completion of the GenAI360 Foundational Model Certification Course must be redeemed within [12] months of the course completion date, after which they will become void.
    Usage: Credits are applicable for use across select programs, courses, workshops, or other specified opportunities offered by Activeloop and/or Cohere or Lambda and cannot be transferred to external platforms or exchanged for cash or other forms of payment.

Terms & Conditions:

    Eligibility: Credits are available only to qualifying participants who have successfully completed the GenAI360 Foundational Model Certification Course and have adhered to all course and evaluation criteria.
    Redemption: Credits can only be redeemed by the individual participant to whom they were issued and are non-transferrable to other individuals or entities.
    Modification: Activeloop reserves the right to modify the availability, applicability, or value of credits without prior notice. Participants will be notified of any such changes via registered email.
    Verification: All participant details and attached documents will undergo a verification process. Any discrepancies or fraudulent information may result in the forfeiture of credits and possible exclusion from future programs.
    Data Protection: Participant data will be handled with utmost confidentiality and will only be used for the purpose of credit redemption, in compliance with applicable data protection regulations.
    Limitation: The credits are not stackable and cannot be combined with other ongoing offers or discounts, unless explicitly mentioned.
    Discrepancies: In case of any discrepancies or issues related to credit redemption, decisions made by Activeloop will be considered final.
    Communication: Participants agree to receive communications regarding the credit redemption process and other relevant information from GenAI360 and Cohere.
    Governing Law: The credit redemption process and associated terms are governed by the applicable laws in the jurisdiction of Activeloop‚Äôs registered location.

By redeeming the credits, participants acknowledge and agree to adhere to the aforementioned terms and conditions. Any violation of the same may result in appropriate actions as deemed suitable by Activeloop.

Intel, the Intel logo, and other Intel marks are trademarks of Intel Corporation or its subsidiaries.

